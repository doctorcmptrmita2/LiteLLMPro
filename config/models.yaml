# CF-X Router - Stage to Model Mapping Configuration
# This file defines which AI models are used for each stage of the workflow.

stages:
  # PLAN Stage: Architecture, specifications, design documents
  # Uses premium model for high-quality reasoning
  plan:
    model: claude-sonnet-4.5
    max_tokens: 4096
    temperature: 0.3
    timeout: 30
    fallback:
      - gemini-2.5-pro
      - gpt-4o

  # CODE Stage: Implementation, code generation, refactoring
  # Uses cost-effective model with good coding performance
  code:
    model: deepseek-v3
    max_tokens: 8192
    temperature: 0.2
    timeout: 60
    fallback:
      - gemini-2.0-flash
      - gpt-4o-mini

  # REVIEW Stage: Code review, security analysis, validation
  # Uses fast, economical model for quick feedback
  review:
    model: gpt-4o-mini
    max_tokens: 2048
    temperature: 0.1
    timeout: 20
    fallback:
      - gemini-flash-lite
      - claude-haiku-3.5

# Direct Mode: Bypass stage routing, use specific model
# Only whitelisted models are allowed
direct:
  allowed_models:
    - claude-sonnet-4.5
    - claude-haiku-3.5
    - gpt-4o
    - gpt-4o-mini
    - deepseek-v3
    - gemini-2.5-pro
    - gemini-2.0-flash
    - gemini-flash-lite
  max_tokens_cap: 8192

# Stage Inference Keywords
# Used when X-CFX-Stage header is not provided
inference:
  plan_keywords:
    - plan
    - design
    - architect
    - spec
    - specification
    - structure
    - approach
    - strategy
    - outline
    - requirements
    - tasarla
    - planla
    - mimari
    
  code_keywords:
    - implement
    - code
    - write
    - create
    - build
    - fix
    - refactor
    - add
    - update
    - modify
    - function
    - class
    - method
    - api
    - yaz
    - kodla
    - oluştur
    - düzelt
    - ekle
    
  review_keywords:
    - review
    - check
    - analyze
    - audit
    - security
    - vulnerability
    - bug
    - issue
    - problem
    - incele
    - kontrol
    - analiz
    - güvenlik

# Rate Limiting (can be overridden by environment variables)
rate_limit:
  daily_requests: 1000
  concurrent_streams: 2

# Circuit Breaker Settings
circuit_breaker:
  failure_threshold: 5
  recovery_timeout: 30
